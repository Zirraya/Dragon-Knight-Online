-- filename: 
-- version: lua51
-- line: [0, 0] id: 0
monster_font = SKYArgbToColor(255, 233, 113, 0)
cha_font = SKYArgbToColor(255, 232, 57, 57)
cha_mana_dam = SKYArgbToColor(255, 0, 75, 255)
cha_dam = SKYArgbToColor(255, 255, 0, 0)
monster_dam_baoji = SKYArgbToColor(255, 255, 255, 0)
monster_dam_noma = SKYArgbToColor(255, 0, 255, 255)
monter_dam_skill = SKYArgbToColor(255, 255, 0, 255)
cha_have_mana = SKYArgbToColor(255, 0, 75, 255)
cha_have_life = SKYArgbToColor(255, 36, 190, 0)
cha_exp_color = SKYArgbToColor(255, 255, 210, 0)
cha_PRESTIGE_CHANGE = SKYArgbToColor(255, 220, 200, 85)
cha_MONEY_CHANGE = SKYArgbToColor(255, 255, 199, 51)
dragon_pic = {
  [6001] = "young_dragon.tga",
  [6003] = "Argentine_dragon.tga",
  [6004] = "white_dragon.tga",
  [6005] = "golden_dragon.tga",
  [6006] = "red_drag.tga",
  [6007] = "blue_dragon.tga",
  [6008] = "black_dragon.tga",
  [6009] = "copper_dragon.tga",
  [6010] = "young_dragon.tga",
  [6016] = "Argentine_dragon.tga",
  [6012] = "white_dragon.tga",
  [6503] = "golden_dragon.tga",
  [6011] = "red_drag.tga",
  [6013] = "blue_dragon.tga",
  [6014] = "black_dragon.tga",
  [6015] = "copper_dragon.tga",
  [6501] = "Argentine_dragon.tga",
  [6502] = "white_dragon.tga",
  [6017] = "golden_dragon.tga",
  [6504] = "red_drag.tga",
  [6505] = "blue_dragon.tga",
  [6506] = "black_dragon.tga",
  [6507] = "copper_dragon.tga",
  [6511] = "Argentine_dragon.tga",
  [6512] = "white_dragon.tga",
  [6513] = "golden_dragon.tga",
  [6514] = "red_drag.tga",
  [6515] = "blue_dragon.tga",
  [6516] = "black_dragon.tga",
  [6517] = "copper_dragon.tga",
}
dragon_pic_dds = {
  [6013] = {
    pic = "yong_blue_dragon.dds",
    x = 204,
    y = 478,
  },
  [6001] = {
    pic = "young_dragon.dds",
    x = 0,
    y = 0,
  },
  [6003] = {
    pic = "Argentine_dragon.dds",
    x = 410,
    y = 478,
  },
  [6004] = {
    pic = "white_dragon.dds",
    x = 615,
    y = 0,
  },
  [6005] = {
    pic = "golden_dragon.dds",
    x = 410,
    y = 240,
  },
  [6006] = {
    pic = "red_drag.dds",
    x = 410,
    y = 0,
  },
  [6007] = {
    pic = "blue_dragon.dds",
    x = 204,
    y = 240,
  },
  [6008] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 240,
  },
  [6009] = {
    pic = "copper_dragon.dds",
    x = 820,
    y = 1,
  },
  [6015] = {
    pic = "yong_blue_dragon.dds",
    x = 204,
    y = 478,
  },
  [6010] = {
    pic = "young_dragon.dds",
    x = 0,
    y = 0,
  },
  [6501] = {
    pic = "Argentine_dragon.dds",
    x = 410,
    y = 478,
  },
  [6502] = {
    pic = "white_dragon.dds",
    x = 615,
    y = 0,
  },
  [6503] = {
    pic = "golden_dragon.dds",
    x = 410,
    y = 240,
  },
  [6504] = {
    pic = "red_drag.dds",
    x = 410,
    y = 0,
  },
  [6505] = {
    pic = "blue_dragon.dds",
    x = 204,
    y = 240,
  },
  [6506] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 240,
  },
  [6507] = {
    pic = "copper_dragon.dds",
    x = 820,
    y = 1,
  },
  [6011] = {
    pic = "yong_blue_dragon.dds",
    x = 204,
    y = 478,
  },
  [6016] = {
    pic = "young_dragon.dds",
    x = 204,
    y = 478,
  },
  [6511] = {
    pic = "Argentine_dragon.dds",
    x = 410,
    y = 478,
  },
  [6512] = {
    pic = "white_dragon.dds",
    x = 615,
    y = 0,
  },
  [6513] = {
    pic = "golden_dragon.dds",
    x = 410,
    y = 240,
  },
  [6514] = {
    pic = "red_drag.dds",
    x = 410,
    y = 0,
  },
  [6515] = {
    pic = "blue_dragon.dds",
    x = 204,
    y = 240,
  },
  [6516] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 240,
  },
  [6517] = {
    pic = "copper_dragon.dds",
    x = 820,
    y = 1,
  },
  [6017] = {
    pic = "young_dragon.dds",
    x = 204,
    y = 478,
  },
  [6012] = {
    pic = "young_dragon.dds",
    x = 204,
    y = 478,
  },
  [6018] = {
    pic = "young_dragon.dds",
    x = 0,
    y = 803,
  },
  [6019] = {
    pic = "young_dragon.dds",
    x = 204,
    y = 803,
  },
  [6020] = {
    pic = "gu_dragon.dds",
    x = 411,
    y = 803,
  },
  [6021] = {
    pic = "feng_dragon.dds",
    x = 621,
    y = 803,
  },
  [6014] = {
    pic = "young_dragon.dds",
    x = 204,
    y = 478,
  },
}
dragon_pic_button_dds = {
  [6013] = {
    pic = "yong_blue_dragon.dds",
    x = 584,
    y = 464,
    name_sub = 8,
  },
  [6001] = {
    pic = "young_dragon.dds",
    x = 455,
    y = 464,
    name_sub = 4,
  },
  [6003] = {
    pic = "Argentine_dragon.dds",
    x = 325,
    y = 464,
    name_sub = 4,
  },
  [6004] = {
    pic = "white_dragon.dds",
    x = 390,
    y = 464,
    name_sub = 4,
  },
  [6005] = {
    pic = "golden_dragon.dds",
    x = 192,
    y = 464,
    name_sub = 4,
  },
  [6006] = {
    pic = "red_drag.dds",
    x = 259,
    y = 464,
    name_sub = 4,
  },
  [6007] = {
    pic = "blue_dragon.dds",
    x = 65,
    y = 464,
    name_sub = 4,
  },
  [6008] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 464,
    name_sub = 4,
  },
  [6009] = {
    pic = "copper_dragon.dds",
    x = 131,
    y = 464,
    name_sub = 6,
  },
  [6015] = {
    pic = "yong_blue_dragon.dds",
    x = 584,
    y = 464,
    name_sub = 8,
  },
  [6010] = {
    pic = "young_dragon.dds",
    x = 455,
    y = 464,
    name_sub = 4,
  },
  [6501] = {
    pic = "Argentine_dragon.dds",
    x = 325,
    y = 464,
    name_sub = 4,
  },
  [6502] = {
    pic = "white_dragon.dds",
    x = 390,
    y = 464,
    name_sub = 4,
  },
  [6503] = {
    pic = "golden_dragon.dds",
    x = 192,
    y = 464,
    name_sub = 4,
  },
  [6504] = {
    pic = "red_drag.dds",
    x = 259,
    y = 464,
    name_sub = 4,
  },
  [6505] = {
    pic = "blue_dragon.dds",
    x = 65,
    y = 464,
    name_sub = 4,
  },
  [6506] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 464,
    name_sub = 4,
  },
  [6507] = {
    pic = "copper_dragon.dds",
    x = 131,
    y = 464,
    name_sub = 6,
  },
  [6014] = {
    pic = "yong_blue_dragon.dds",
    x = 584,
    y = 464,
    name_sub = 8,
  },
  [6016] = {
    pic = "young_dragon.dds",
    x = 455,
    y = 464,
    name_sub = 8,
  },
  [6511] = {
    pic = "Argentine_dragon.dds",
    x = 325,
    y = 464,
    name_sub = 4,
  },
  [6512] = {
    pic = "white_dragon.dds",
    x = 390,
    y = 464,
    name_sub = 4,
  },
  [6513] = {
    pic = "golden_dragon.dds",
    x = 192,
    y = 464,
    name_sub = 4,
  },
  [6514] = {
    pic = "red_drag.dds",
    x = 259,
    y = 464,
    name_sub = 4,
  },
  [6515] = {
    pic = "blue_dragon.dds",
    x = 65,
    y = 464,
    name_sub = 4,
  },
  [6516] = {
    pic = "black_dragon.dds",
    x = 0,
    y = 464,
    name_sub = 4,
  },
  [6517] = {
    pic = "copper_dragon.dds",
    x = 131,
    y = 464,
    name_sub = 6,
  },
  [6017] = {
    pic = "young_dragon.dds",
    x = 455,
    y = 464,
    name_sub = 4,
  },
  [6012] = {
    pic = "young_dragon.dds",
    x = 455,
    y = 464,
    name_sub = 4,
  },
  [6018] = {
    pic = "jingling_dragon.dds",
    x = 714,
    y = 464,
    name_sub = 6,
  },
  [6019] = {
    pic = "gu_dragon.dds",
    x = 649,
    y = 464,
    name_sub = 6,
  },
  [6020] = {
    pic = "gu_dragon.dds",
    x = 840,
    y = 464,
    name_sub = 6,
  },
  [6011] = {
    pic = "yong_blue_dragon.dds",
    x = 584,
    y = 464,
    name_sub = 8,
  },
  [6021] = {
    pic = "gu_dragon.dds",
    x = 913,
    y = 464,
    name_sub = 4,
  },
}
dragon_pet = 0
mode_lock = 0
disconnet_tag = 0
function app_proc(r0_1, r1_1, r2_1)
  -- line: [51, 1259] id: 1
  local r3_1 = FindFormUI(frmNPC_pageboy, "pageup")
  local r4_1 = FindFormUI(frmNPC_pageboy, "pagedown")
  local r5_1 = FindFormUI(frmNPC_pageboy, "black")
  local r6_1 = FindFormUI(frmNPC_pageboy, "pageup1")
  local r7_1 = FindFormUI(frmNPC_pageboy, "pagedown1")
  if r1_1 == MSG_APP_NET_DISCONNECT then
    prompt_close_proc()
    SKY_Set(dskGamemain, PROP_DESKTOP_FUNCTIONKEY_EXIT)
    kitbag = 1
    SKY_Set(VAR_APP, PROP_APP_EXIT_GAME_WORLD)
    if disconnet_tag == 0 then
      SKY_Set(VAR_UI_DIALOG, PROP_UI_DIALOG_MSGBOX, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1056))
    end
    SKY_Set(VAR_APP, PROP_APP_SWITCH_SCENE, VAR_APP_SCENE_NULL)
    SKY_Set(VAR_SCREEN, PROP_SCREEN_DESKTOP, dskLogin)
    SD_login_acc = 0
    SKY_Set(frmLogin, PROP_FORM_SHOW, VAR_TRUE)
    if g_GAME_VISION == VAR_APP_GAME_DEFAULT then
      SKY_Set(FindFormUI(frmLogin, "btnDragon"), PROP_UI_BUTTON_CLICK)
    end
    SKY_Get(VAR_APP, PROP_APP_ACCOUNT_SAVE)
    SKY_Set(VAR_ENGINE, PROP_ENGINE_RENDER)
    local r8_1 = SKYParamParse(r2_1)
    disconnet_tag = 0
    if r8_1 ~= 0 then
    end
  elseif r1_1 == MSG_APP_SHUN_YOU_REMAIN then
    local r8_1 = SKYParamPop(r2_1)
    if PressShunYouCoin then
      SKY_Set(VAR_UI_DIALOG, PROP_UI_DIALOG_MSGBOX, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1057) .. r8_1)
      PressShunYouCoin = false
    elseif SKY_Get(frmBusiness, PROP_FORM_SHOW) == VAR_TRUE then
      SKY_Set(FindFormUI(frmBusiness, "kedou_label"), PROP_UI_TEXT, r8_1)
    else
      SKY_Set(FindFormUI(frmorder, "kedou_label"), PROP_UI_TEXT, r8_1)
    end
  elseif r1_1 == MSG_APP_ADD_PASS_CHA then
    pasd_label_num(1)
  elseif r1_1 == MSG_APP_SNDA_LOGIN then
    SD_LoginProc()
  elseif r1_1 == MSG_APP_REPLY_NOTIFICATION then
    local r8_1 = SKYParamPop(r2_1)
    local r9_1 = SKYParamPop(r2_1)
    local r10_1 = SKYParamPop(r2_1)
    local r11_1 = SKYArgbToColor(255, 0, 0, 0)
    SKY_Set(systeminfo, PROP_UI_MEMO_CLEAR)
    SKY_Set(systeminfo, PROP_UI_MEMO_NEW_TEXT, r8_1, DEFALUT_FONT1, 4285152768, VAR_FALSE)
    SKY_Set(systeminfo, PROP_UI_MEMO_NEW_TEXT, "            ", DEFALUT_FONT, 4285152768, VAR_FALSE)
    SKY_Set(systeminfo, PROP_UI_MEMO_NEW_TEXT, r10_1, DEFALUT_FONT, 4285152768, VAR_FALSE)
    SKY_Set(systeminfo, PROP_UI_MEMO_PARSE)
    SKY_Set(systeminfo, PROP_UI_MEMO_SELECT_FIRST)
  elseif r1_1 == MSG_APP_TARGET_BELONG_CHANGE then
    target_cha_refresh(MainCha(), SKY_Get(VAR_FORM_MAIN, PROP_MAIN_TARGET))
  elseif r1_1 == MSG_APP_REPLY_SERVER_LIST then
    tiaoshi_table = {}
    local r8_1 = SKYParamPop(r2_1)
    server_table = {}
    local r9_1 = 0
    local r10_1 = 0
    for r14_1 = 1, r8_1, 1 do
      r9_1 = SKYParamPop(r2_1)
      tiaoshi_table[r14_1] = r9_1
      local r15_1 = SKY_Get(login_combo_server_name, PROP_UI_MENU_ITEM)
      SKY_Set(r15_1, PROP_MENU_GROUP_ADD_TEXT, tostring(r9_1), DEFALUT_FONT3, COLOR_GOLDEN)
      SKY_Set(r15_1, PROP_MENU_GROUP_UNIT_SIZE, 136, 23)
      r10_1 = SKYParamPop(r2_1)
      server_table[r14_1] = r10_1
      for r19_1 = 1, r10_1, 1 do
        local r20_1 = SKYParamPop(r2_1)
        if r14_1 < 2 then
          server_list(r20_1, tonumber(r14_1 .. r19_1))
        end
        server_table[tonumber(r14_1 .. r19_1)] = {}
        local r21_1 = SKYParamPop(r2_1)
        server_table[tonumber(r14_1 .. r19_1)].ip_name = r20_1
        server_table[tonumber(r14_1 .. r19_1)].ip_num = r21_1
        server_table[tonumber(r14_1 .. r19_1)].ip_table = {}
        for r25_1 = 1, r21_1, 1 do
          server_table[tonumber(r14_1 .. r19_1)].ip_table[r25_1] = SKYParamPop(r2_1)
        end
      end
    end
    if g_GAME_VISION == VAR_APP_GAME_DEFAULT then
      SKY_Set(item_select, PROP_ITEM_LIST_SELECT, 0)
    elseif g_GAME_VISION == VAR_APP_GAME_SHUN and r10_1 == 1 then
      SKY_Set(item_select, PROP_ITEM_LIST_SELECT, 0)
    end
    SKY_Get(VAR_APP, PROP_APP_ACCOUNT_SAVE)
  elseif r1_1 == MSG_APP_WAR_BEGIN then
    SKY_Set(FindFormUI(frmMap, "btncmpwar"), PROP_UI_SHOW, VAR_TRUE)
    local r9_1 = SKY_Set(VAR_UI_DIALOG, PROP_UI_DIALOG_SELECTBOX, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1058))
    prompt_close_proc()
    Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1059))
    if r9_1 == VAR_TRUE then
      SKY_Set(VAR_APP, PROP_APP_WAR_MOVE)
    end
  elseif r1_1 == MSG_APP_WAR_END then
    SKY_Set(FindFormUI(frmMap, "btncmpwar"), PROP_UI_SHOW, VAR_FALSE)
  elseif r1_1 == MSG_APP_ACCOUNT_SAVE then
    SKY_Set(FindFormUI(frmLogin, "saveAccount"), PROP_UI_CHECK_CHECK, SKYParamPop(r2_1))
    SKY_Set(SKY_Get(frmLogin, PROP_FORM_FIND, "edtAccount"), PROP_UI_TEXT, SKYParamPop(r2_1))
    local r11_1 = SKYParamPop(r2_1)
    local r12_1 = FindFormUI(frmLogin, "servercombox")
    if r11_1 == -1 then
      r11_1 = 0
    end
    local r13_1 = r11_1 + 1
    local r14_1 = server_table[r13_1]
    SKY_Set(SKY_Get(FindFormUI(frmLogin, "serverchang"), PROP_UI_LIST_ITEM), PROP_ITEM_LIST_CLEAR)
    if r14_1 == nil then
      return 
    end
    for r20_1 = 1, r14_1, 1 do
      server_list(server_table[tonumber(r13_1 .. r20_1)].ip_name, tonumber(r13_1 .. r20_1))
    end
    SKY_Set(r12_1, PROP_UI_COMBO_BOX_SELECT_ID, r11_1)
    local r17_1 = SKYParamPop(r2_1)
    if r17_1 == -1 then
      r17_1 = 0
    end
    SKY_Set(item_select, PROP_ITEM_LIST_SELECT, r17_1)
  elseif r1_1 == MSG_APP_EXIST_AREAID then
    list_clear()
    local r8_1 = SKYParamPop(r2_1)
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1060) .. r8_1)
    local r9_1 = SKY_Get(VAR_TABLE_EXIST_AREA, PROP_TABLE_ROW_COUNT)
    local r10_1 = 1
    area_id_table = {}
    for r14_1 = 0, r9_1 - 1, 1 do
      if SKYGetBit(r8_1, r14_1) == 1 then
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1061) .. SKYGetBit(r8_1, r14_1))
        area_id_table[r10_1] = r14_1 + 1
        r10_1 = r10_1 + 1
      end
    end
    local r11_1 = table.getn(area_id_table)
    if r11_1 ~= 0 then
      local r12_1 = FindFormUI(frm_btnminimap_control, "btnminimap_control")
      SKY_Set(r12_1, PROP_UI_TIME_INTERVAL, 500)
      SKY_Set(r12_1, PROP_UI_TIME_START)
    end
    SKY_Set(formnamelabel[1], PROP_UI_TAG, 1)
    SKY_Set(formnamelabel[2], PROP_UI_TAG, 1)
    if 4 <= r11_1 and math.mod(r11_1, 4) == 0 then
      SKY_Set(formnamelabel[3], PROP_UI_TAG, 4)
    else
      SKY_Set(formnamelabel[3], PROP_UI_TAG, math.mod(r11_1, 4))
    end
    SKY_Set(formnamelabel[4], PROP_UI_TAG, math.ceil(r11_1 / 4))
    if r11_1 >= 4 then
      SKY_Set(btnpageup, PROP_UI_SHOW, VAR_TRUE)
      SKY_Set(btnpagenext, PROP_UI_SHOW, VAR_TRUE)
    else
      SKY_Set(btnpageup, PROP_UI_SHOW, VAR_FALSE)
      SKY_Set(btnpagenext, PROP_UI_SHOW, VAR_FALSE)
    end
  elseif r1_1 == MSG_APP_OPEN_SALE then
    local r9_1 = SKY_Get(SKYParamPop(r2_1), PROP_CHA_ID)
    Storelist.IDSell = 0
    SKY_Set(VAR_PLAYER_STORE, PROP_QUERY_STORE_INFO, r9_1)
  elseif r1_1 == MSG_APP_CHA_OPEN_BANK then
    SKY_Set(frmKitbag, PROP_FORM_SHOW, VAR_TRUE)
    SKY_Set(frmBank, PROP_FORM_SHOW, VAR_TRUE)
    bank_cha = SKY_Get(SKY_Get(VAR_APP, PROP_APP_SCENE), PROP_SCENE_FIND, SKYParamParse(r2_1))
    if bank_cha ~= nil then
      SKY_Set(VAR_FORM_MAIN, PROP_MAIN_ADD_DIS_FORM, bank_cha, frmBank, 1000)
    end
    return 
  elseif r1_1 == MSG_APP_MONSTER_HATERD then
    local r8_1 = SKYParamPop(r2_1)
    hatred_info = tonumber(r8_1)
    if r8_1 == 0 then
      return 
    end
    local r9_1 = nil
    for r13_1 = 1, r8_1, 1 do
      GM_TABLE[r13_1] = {}
      GM_TABLE[r13_1].name = SKYParamPop(r2_1)
      GM_TABLE[r13_1].hatred_num = SKYParamPop(r2_1)
      GM_TABLE[r13_1].id = SKYParamPop(r2_1)
    end
  elseif r1_1 == MSG_APP_CHAT_FLASH then
    local r8_1 = SKYParamPop(r2_1)
    local r9_1 = FindFormUI(frmchatTime, "timechat")
    local r10_1 = FindFormUI(frmchatTime, "timefight")
    local r11_1 = FindFormUI(frmchatTime, "timecollect")
    if r8_1 == 1 then
      SKY_Set(r10_1, PROP_UI_TIME_INTERVAL, 1000)
      SKY_Set(r10_1, PROP_UI_TIME_START)
    elseif r8_1 == 2 then
      SKY_Set(r11_1, PROP_UI_TIME_INTERVAL, 1000)
      SKY_Set(r11_1, PROP_UI_TIME_START)
    elseif r8_1 == 3 then
      SKY_Set(r9_1, PROP_UI_TIME_INTERVAL, 1000)
      SKY_Set(r9_1, PROP_UI_TIME_START)
    end
  elseif r1_1 == MSG_APP_CHAT_SELECT_INFO then
    local r8_1 = SKYParamPop(r2_1)
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1062) .. r8_1)
    if r8_1 == 1 then
      chat_list_bool(VAR_TRUE, VAR_FALSE, VAR_FALSE, VAR_FALSE)
    elseif r8_1 == 2 then
      chat_list_bool(VAR_FALSE, VAR_TRUE, VAR_FALSE, VAR_FALSE)
    elseif r8_1 == 3 then
      chat_list_bool(VAR_FALSE, VAR_FALSE, VAR_TRUE, VAR_FALSE)
    elseif r8_1 == 4 then
      chat_list_bool(VAR_FALSE, VAR_FALSE, VAR_FALSE, VAR_TRUE)
    end
  elseif r1_1 == MSG_APP_SUIT_INFO then
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1063))
    local r8_1 = 0
    local r9_1 = 0
    local r10_1 = 0
    local r11_1 = 0
    local r12_1 = 0
    suit_equip = {}
    for r17_1 = 1, SKYParamPop(r2_1), 1 do
      r9_1 = SKYParamPop(r2_1)
      r10_1 = math.ceil(math.mod(SKYParamPop(r2_1), 65536) / 100)
      if 0 < r9_1 and SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, r9_1, "SuitID") ~= nil then
        suit_equip_id = tonumber(SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, r9_1, "SuitID"))
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1064) .. r10_1)
        if suit_equip_id ~= 0 and r10_1 ~= 0 and suit_equip[suit_equip_id] ~= nil then
          SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1065) .. suit_equip_id)
          suit_equip[suit_equip_id].count = suit_equip[suit_equip_id].count + 1
        elseif r10_1 ~= 0 then
          suit_equip[suit_equip_id] = {}
          suit_equip[suit_equip_id].count = 1
          SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1066) .. suit_equip[suit_equip_id].count)
        end
      end
    end
  elseif r1_1 == MSG_APP_MAIN_CHA_COLOR_CHANGE then
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1067))
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1068) .. SKYParamCount(r2_1))
    local r8_1 = SKYParamPop(r2_1)
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1069) .. r8_1)
    if r8_1 ~= 0 then
      local r9_1 = FindFormUI(frmTime, "time")
      red_time = r8_1
      SKY_Set(r9_1, PROP_UI_TIME_INTERVAL, 1000)
      SKY_Set(r9_1, PROP_UI_TIME_START)
    elseif r8_1 == 0 then
      SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1070) .. r8_1)
    end
  elseif r1_1 == MSG_APP_AUTOMATIC_HPMP then
    local r8_1 = SKYParamPop(r2_1)
    local r9_1 = SKYParamPop(r2_1)
    local r10_1 = SKYParamPop(r2_1)
    local r11_1 = {
      [0] = listHp,
      [1] = listMp,
    }
    local r12_1 = {
      [0] = HPcombox,
      [1] = mpcombox,
    }
    hp_mp_list[r9_1] = {}
    hp_mp_list[r9_1].id = r8_1
    hp_mp_list[r9_1].here = r9_1
    SKY_Set(SKY_Get(r11_1[r9_1], PROP_UI_LIST_ITEM), PROP_ITEM_GRID_CLEAR_ITEM)
    local r13_1 = SKY_Create(TYPE_ITEM_GOODS, "", r8_1)
    SKY_Set(r13_1, PROP_NAME, Equip_GetViewName(r13_1, 0, 0, 0, 0, 0))
    SKY_Set(SKY_Get(r11_1[r9_1], PROP_UI_LIST_ITEM), PROP_ITEM_GRID_SET_ITEM, 0, r13_1)
    SKY_Set(r12_1[r9_1], PROP_UI_SHOW, VAR_TRUE)
    SKY_Set(r12_1[r9_1], PROP_UI_TEXT, r10_1 .. "%")
    SKY_Set(frmsolveHp, PROP_UI_REFRESH)
  elseif r1_1 == MSG_APP_PKMODE_CHANGE then
    local r8_1 = MainCha()
    local r9_1 = SKY_Get(frmPlay, PROP_FORM_FIND, "pk_swtich")
    local r10_1 = FindFormUI(frmPlay, "light_black")
    if r8_1 ~= nil or r8_1 ~= 0 then
      if SKY_Get(r8_1, PROP_GAME_CHA_PVP_STATE) == 1 then
        SKY_Set(r10_1, PROP_UI_SHOW, VAR_TRUE)
        SKY_Set(r9_1, PROP_UI_HINT, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1071))
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 0), "main\\chaform.dds", 20, 20, 304, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 1), "main\\chaform.dds", 20, 20, 278, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 2), "main\\chaform.dds", 20, 20, 278, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 3), "main\\chaform.dds", 20, 20, 278, 309)
        maintext_show(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1072))
      else
        SKY_Set(r10_1, PROP_UI_SHOW, VAR_FALSE)
        SKY_Set(r9_1, PROP_UI_HINT, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1073))
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 0), "main\\chaform.dds", 20, 20, 278, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 1), "main\\chaform.dds", 20, 20, 304, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 2), "main\\chaform.dds", 20, 20, 304, 309)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE, 3), "main\\chaform.dds", 20, 20, 304, 309)
        maintext_show(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1074))
      end
      SKY_Set(frmPlay, PROP_UI_REFRESH)
    end
  elseif r1_1 == MSG_APP_SENDRES_NUM then
    local r8_1 = FindFormUI(frmMap, "lblResNum")
    if r8_1 ~= nil then
      local r9_1, r10_1 = SKYParamParse(r2_1)
      SKY_Set(r8_1, PROP_UI_COLOR, 255, math.min(200, 2.55 * (r9_1 - r10_1) * 200), math.min(255, 2.55 * r10_1 * 10), 0)
      SKY_Set(r8_1, PROP_UI_TEXT, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1075) .. r10_1 .. "/" .. r9_1)
      if 0 == tonumber(r9_1) and 0 == tonumber(r10_1) then
        SKY_Set(r8_1, PROP_UI_SHOW, VAR_FALSE)
      else
        SKY_Set(r8_1, PROP_UI_SHOW, VAR_TRUE)
      end
    end
    SKY_Set(frmMap, PROP_UI_REFRESH)
  elseif r1_1 == MSG_APP_PKMODE_LOCK then
    mode_lock = SKYParamPop(r2_1)
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1076) .. mode_lock)
  elseif r1_1 == MSG_APP_USE_MOVEGOODS then
    SKY_Set(frmRemit, PROP_FORM_SHOW, VAR_TRUE)
  elseif r1_1 == MSG_APP_REVIDRONFORM_OPEN then
    local r8_1 = SKYParamPop(r2_1)
    local r10_1 = SKY_Get(VAR_TABLE_NPC, PROP_TABLE_DATA, SKYParamPop(r2_1), "Name")
    SKY_Set(frmflydrelive, PROP_FORM_SHOW, VAR_TRUE)
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1077) .. r10_1)
  elseif r1_1 == MSG_APP_REPAIRALL_MONEY then
    local r8_1 = nil
    a = {}
    for r12_1 = 1, 16, 1 do
      a[r12_1] = SKYParamPop(r2_1)
    end
    allrepair_cost = allrepair_money(16)
    if allrepair_cost < 0 then
      allrepair_cost = 0
    end
    SKY_Set(VAR_APP, PROP_APP_REPAIRALL_MONEY, allrepair_cost)
  elseif r1_1 == MSG_APP_SKILL_HINT then
    ShowSkillHint(SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP), r2_1)
    return 1
  elseif r1_1 == MSG_APP_HARM then
    local r8_1, r9_1, r10_1, r11_1, r12_1, r13_1, r14_1 = SKYParamParse(r2_1)
    local r15_1 = VAR_CHA_EFF_TYPE_GENERIC
    local r16_1 = Partical_NUM
    if r12_1 == VAR_FALSE and r14_1 == VAR_FALSE then
      return 
    end
    if SKYGetBit(r11_1, 0) == VAR_TRUE then
      r15_1 = VAR_CHA_EFF_TYPE_CRITICAL
    elseif r12_1 == VAR_TRUE then
      if r10_1 > 0 then
        r15_1 = VAR_CHA_EFF_TYPE_SUFFER0
      else
        r15_1 = VAR_CHA_EFF_TYPE_SUFFER1
      end
    end
    if SKYGetBit(r11_1, 1) == VAR_TRUE then
      r16_1 = Partical_SHIELD
    end
    if r10_1 == 0 then
      r15_1 = VAR_CHA_EFF_TYPE_GENERIC
      local r17_1 = 0
      if r12_1 == VAR_TRUE then
        r17_1 = Partical_Self_goodcolor
      else
        r17_1 = Partical_Self_badcolor
      end
      if r11_1 == 1 then
        r16_1 = Partical_EVADE
      elseif r11_1 == 2 then
        r16_1 = Partical_RISIST
      elseif r11_1 == 3 then
        r16_1 = Partical_DODGE
      elseif r11_1 == 4 then
        r16_1 = Partical_ABSORB
      elseif r11_1 == 5 then
        r16_1 = Partical_ENABLE
      end
      if r12_1 == VAR_TRUE then
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, 0, r15_1, r16_1, VAR_FALSE, monster_font)
      else
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, 0, r15_1, r16_1, VAR_FALSE, cha_font)
      end
    elseif r10_1 > 0 then
      if SKYGetBit(r11_1, 2) == VAR_TRUE then
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, cha_mana_dam)
      elseif r12_1 == VAR_TRUE then
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, cha_dam)
      elseif SKYGetBit(r11_1, 0) == VAR_TRUE then
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, monster_dam_baoji)
      elseif r13_1 == VAR_FALSE then
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, monster_dam_noma)
      else
        SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, monter_dam_skill)
      end
    elseif SKYGetBit(r11_1, 2) == VAR_TRUE then
      SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, cha_have_mana)
    else
      SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1 * -1, r15_1, r16_1, VAR_TRUE, cha_have_life)
    end
  elseif r1_1 == MSG_APP_PRESTIGE_CHANGE then
    local r8_1, r9_1, r10_1 = SKYParamParse(r2_1)
    SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r10_1, VAR_CHA_EFF_TYPE_GENERIC, Partical_Honor, VAR_TRUE, cha_PRESTIGE_CHANGE)
  elseif r1_1 == MSG_APP_EXP_CHANGE then
    local r8_1, r9_1 = SKYParamParse(r2_1)
    SKY_Set(r8_1, PROP_GAME_CHA_HARM_EFF, r9_1, VAR_CHA_EFF_TYPE_GENERIC, Partical_EXP, VAR_TRUE, cha_exp_color)
  elseif r1_1 == MSG_APP_GOODS_HINT then
    Show_ItemHint(SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP), SKYParamParse(r2_1), 1)
    return VAR_TRUE
  elseif r1_1 == MSG_APP_FAST_ITEM_HINT then
    Show_FastItemHint(SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP), SKYParamPop(r2_1), SKYParamPop(r2_1), SKYParamPop(r2_1), SKYParamPop(r2_1))
    return VAR_TRUE
  elseif r1_1 == MSG_APP_CHARMSG_HINT then
    local r8_1 = SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP)
    SKY_Set(r8_1, PROP_DESKTOP_HINT_ISCLEAR, VAR_FALSE)
    local r9_1 = SKYParamPop(r2_1)
    local r10_1 = nil
    local r11_1 = nil
    local r12_1 = nil
    local r13_1 = nil
    local r14_1 = nil
    local r15_1 = nil
    r10_1 = SKYParamPop(r2_1)
    r11_1 = SKYParamPop(r2_1)
    r12_1 = SKYParamPop(r2_1)
    r13_1 = SKYParamPop(r2_1)
    r14_1 = SKYParamPop(r2_1)
    if r9_1 > 0 then
      goodsitem = SKY_Create(TYPE_ITEM_GOODS, "", r9_1)
      SKY_Set(goodsitem, PROP_ITEM_GOODS_ATTR, r10_1, r11_1, r12_1, r13_1, r14_1)
      SKY_Set(goodsitem, PROP_NAME, Equip_GetViewName(goodsitem, 0, 0, 0, 0, 0))
    else
      goodsitem = SKY_Create(TYPE_ITEM_GOODS, "", tonumber("-" .. r10_1))
      SKY_Set(goodsitem, PROP_ITEM_GOODS_ATTR, r10_1, r11_1, r12_1, r13_1, r14_1)
      SKY_Set(goodsitem, PROP_NAME, Equip_GetViewName(goodsitem, 0, r11_1, r12_1, r13_1, r14_1))
    end
    Show_ItemHint(r8_1, goodsitem, 1)
    return VAR_TRUE
  elseif r1_1 == MSG_APP_GOODS_DOUBLE_HINT then
    local r8_1 = SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP)
    local r9_1 = SKYParamPop(r2_1)
    if SKYParamPop(r2_1) == VAR_FALSE then
      SKY_Set(r8_1, PROP_DESKTOP_HINT_ISCLEAR, VAR_FALSE)
    end
    Show_ItemHint(r8_1, r9_1, 2)
    return VAR_TRUE
  elseif r1_1 == MSG_APP_GOODS_THREE_HINT then
    local r8_1 = SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP)
    local r9_1 = SKYParamPop(r2_1)
    if SKYParamPop(r2_1) == VAR_FALSE then
      SKY_Set(r8_1, PROP_DESKTOP_HINT_ISCLEAR, VAR_FALSE)
    end
    Show_ItemHint(r8_1, r9_1, 3)
    return VAR_TRUE
  elseif r1_1 == MSG_APP_GET_MISSION_ITEM then
    maintext_show(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1078))
  elseif r1_1 == MSG_APP_AREA_CHANGE then
    player_zone_change(SKYParamParse(r2_1))
  elseif r1_1 == MSG_APP_READY_EXIT then
    if SKY_Get(VAR_NET, PROP_NET_STATE) == VAR_NET_SUCCESSED and SKY_Get(SKY_Get(VAR_APP, PROP_APP_SCENE), PROP_TYPE_ID) == TYPE_WORLD_SCENE then
      SKY_Set(frmExit, PROP_FORM_SHOW_TOP)
      SKY_Set(VAR_FORM_MAIN, PROP_MAIN_PLAYER_OPERATOR, VAR_FALSE)
      Exitcontrol.Exitname = "Exit"
      return VAR_FALSE
    end
    return VAR_TRUE
  elseif r1_1 == MSG_APP_STATE_HINT then
    local r8_1 = SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP)
    local r9_1 = SKYParamParse(r2_1)
    local r10_1 = SKY_Get(r9_1, PROP_ITEM_STATE_ID)
    SKY_Set(r8_1, PROP_DESKTOP_HINT_TEXT, SKY_Get(VAR_TABLE_STATE, PROP_TABLE_DATA, r10_1, "StatusName"))
    SKY_Set(r8_1, PROP_DESKTOP_HINT_TEXT, SKY_Get(VAR_TABLE_STATE, PROP_TABLE_DATA, r10_1, "StateExplain"))
    SKY_Set(r8_1, PROP_DESKTOP_HINT_TEXT, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1079) .. math.floor(SKY_Get(r9_1, PROP_ITEM_STATE_TIME) / 1000) .. SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1080))
    return VAR_TRUE
  elseif r1_1 == MSG_APP_ITEM_NAME then
    return Equip_GetRandomName(r2_1)
  elseif r1_1 == MSG_APP_FIRST_TRACK then
    SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1081))
    area_id = SKYParamPop(r2_1)
    close_tag = 1
    prompt_close_proc()
    Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1082), "\"M\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1083))
    SKY_Set(FindFormUI(frmMap, "btnpaopao3"), PROP_UI_SHOW, VAR_TRUE)
  elseif r1_1 ~= MSG_APP_FIRST_GAME then
    if r1_1 == MSG_APP_FIRST_DRAGON_WING_EMBLEM then
      prompt_close_proc()
      Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1084))
    elseif r1_1 == MSG_APP_FIRST_HP_MP then
      prompt_close_proc()
      Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1085), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1086), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1087))
    elseif r1_1 == MSG_APP_FIRST_SAME_CAMP_PLAYER then
      prompt_close_proc()
      Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1088))
    elseif r1_1 == MSG_APP_FIRST_SOCKET_EQUIP then
      prompt_close_proc()
      Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1089), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1090), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1091))
    elseif r1_1 == MSG_APP_FIRST_MONSTER then
      prompt_close_proc()
      Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1092), "\"Z\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1093))
      SKY_Set(autogetcartoonform, PROP_FORM_SHOW, VAR_TRUE)
    elseif r1_1 ~= MSG_APP_FIRST_CAMP_WAR then
      if r1_1 == MSG_APP_FIRST_NPC then
        SKY_Set(frmQuestList, PROP_FORM_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_FIRST_QUEST_LIST then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1094), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1095), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1096), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1097))
      elseif r1_1 == MSG_APP_MISSION_FINISHED then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1098))
      elseif r1_1 == MSG_APP_MONSTER_IN_SIGHT then
        prompt_close_proc()
        local r8_1 = SKY_Get(VAR_APP, PROP_APP_MOUSE_SWAP)
        local r9_1 = SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1099)
        if r8_1 == 0 then
          r9_1 = SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1100)
        end
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1101), "\"K\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1102), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1103))
      elseif r1_1 == MSG_APP_FIRST_DRAGON then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1104))
      elseif r1_1 == MSG_APP_FIRST_LEVEL_UP then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1105))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_ENERGY then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1106))
      elseif r1_1 == MSG_APP_FIRST_SAME_CAMP_PLAYER then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1107), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1108), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1109))
      elseif r1_1 == MSG_APP_TARGET_PLAYER then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1110), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1111), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1112))
      elseif r1_1 == MSG_APP_RESOURCE_IN_SIGHT then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1113))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_SKILL_FORM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1114), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1115), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1116), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1117))
      elseif r1_1 == MSG_APP_FIRST_SKILL_FORM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1118), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1119), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1120), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1121))
      elseif r1_1 == MSG_APP_FIRST_TEAM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1122), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1123), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1124), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1125))
      elseif r1_1 == MSG_APP_FIRST_EQUIP then
        chalevel = SKY_Get(MainCha(), PROP_GAME_CHA_ATTR, VAR_ATTR_LEVEL)
        if chalevel <= 6 then
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1126), "\"C\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1127), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1128))
          SKY_Set(FindFormUI(frmMap, "btnpaopao"), PROP_UI_SHOW, VAR_FALSE)
        else
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1129), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1130), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1131))
          SKY_Set(FindFormUI(frmMap, "btnpaopao"), PROP_UI_SHOW, VAR_TRUE)
        end
      elseif r1_1 == MSG_APP_FIRST_EXP_OR_MONEY then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1132), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1133), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1134))
        SKY_Set(FindFormUI(frmMap, "btnpaopao"), PROP_UI_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_FIRST_ADD_FRIEND then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1135), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1136), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1137), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1138))
        SKY_Set(FindFormUI(frmMap, "btnpaopao"), PROP_UI_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_TARGET_PLAYER_OVER_34 then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1139), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1140), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1141))
      elseif r1_1 == MSG_APP_FIRST_HAS_MASTER then
        chalevel = SKY_Get(MainCha(), PROP_GAME_CHA_ATTR, VAR_ATTR_LEVEL)
        if chalevel < 40 then
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1142))
        else
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1143))
        end
      elseif r1_1 == MSG_APP_FIRST_STUDENT_KNIGHT_EMBLEM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1144))
      elseif r1_1 == MSG_APP_FIRST_MASTER_KNIGHT_EMBLEM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1145))
      elseif r1_1 == MSG_APP_END_STUD_MASTER_RELATION then
        chalevel = SKY_Get(MainCha(), PROP_GAME_CHA_ATTR, VAR_ATTR_LEVEL)
        if chalevel < 40 then
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1146))
        else
          prompt_close_proc()
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1147))
        end
      elseif r1_1 == MSG_APP_ADVANTAGE_OF_MASTER then
        prompt_close_proc()
        local r8_1 = MainCha()
        if SKY_Get(r8_1, PROP_GAME_CHA_CAMP_ID) == 1 then
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1148))
        elseif SKY_Get(r8_1, PROP_GAME_CHA_CAMP_ID) == 2 then
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1149))
        end
      elseif r1_1 == MSG_APP_ADVANTAGE_OF_FINISH_STUDENT then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1150))
      elseif r1_1 == MSG_APP_FIRST_ELITE_MISSION then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1151))
      elseif r1_1 == MSG_APP_FIRST_RIDE then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1152), "\"K\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1153))
      elseif r1_1 == MSG_APP_FIRST_HUNGRY_20 then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1154), nil, nil, "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1155))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_SKILL_EXP_USED_UP then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1156), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1157), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1158))
      elseif r1_1 == MSG_APP_FIRST_GUILD_WAR then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1159), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1160), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1161))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_DEATH then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1162))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_ATTR_UP then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1163), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1164), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1165))
      elseif r1_1 == MSG_APP_FIRST_GUILD_TECH then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1166))
      elseif r1_1 == MSG_APP_FIRST_IN_ROOKIE then
        SKY_Set(frmKeyCartoon, PROP_FORM_SHOW, VAR_FALSE)
        SKY_Set(frmOpeningTimer, PROP_FORM_SHOW, VAR_FALSE)
        SKY_Set(frmOpeningTimer, PROP_UI_REFRESH)
        SKY_Set(frmdragon_downstroyform, PROP_FORM_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_FIRST_HAS_MASTER then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1167), "\"F\"", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1168), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1169))
      elseif r1_1 == MSG_APP_FIRST_STUDENT_KNIGHT_EMBLEM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1170))
      elseif r1_1 == MSG_APP_FIRST_MASTER_KNIGHT_EMBLEM then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1171))
      elseif r1_1 == MSG_APP_FIRST_GOOD_EVALUATION then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1172))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_EGG then
        prompt_close_proc()
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1173))
        local r8_1 = FindFormUI(frmPet, "petbubble")
        SKY_Set(r8_1, PROP_UI_SHOW, VAR_TRUE)
        SKYImageLoad(SKY_Get(r8_1, PROP_UI_IMAGE), "equip\\pet.dds", 96, 75, 37, 599)
        local r9_1 = FindFormUI(frmPet, "petbubble1")
        SKY_Set(r9_1, PROP_UI_SHOW, VAR_TRUE)
        SKYImageLoad(SKY_Get(r9_1, PROP_UI_IMAGE), "equip\\pet.dds", 188, 109, 158, 599)
        local r10_1 = FindFormUI(frmPet, "petbubble2")
        SKY_Set(r10_1, PROP_UI_SHOW, VAR_TRUE)
        SKYImageLoad(SKY_Get(r10_1, PROP_UI_IMAGE), "equip\\pet.dds", 153, 96, 31, 702)
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1174), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1175), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1176), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1177))
      elseif r1_1 == MSG_APP_FIRST_SKILL_UP then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1178))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_BABY then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1179), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1180), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1181), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1182))
      elseif r1_1 == MSG_APP_FIRST_INFANT_DRAGON then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1183), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1184), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1185), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1186))
      elseif r1_1 == MSG_APP_FIRST_BATTLE_DRAGON then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1187), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1188), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1189), "show", SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1190))
      elseif r1_1 == MSG_APP_FIRST_DRAGON_FOOD_EMPTY then
        prompt_close_proc()
        local r8_1 = MainCha()
        if SKY_Get(r8_1, PROP_GAME_CHA_CAMP_ID) == 1 then
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1191), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1192), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1193))
        elseif SKY_Get(r8_1, PROP_GAME_CHA_CAMP_ID) == 2 then
          Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1194), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1195), SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1196))
        end
      elseif r1_1 == MSG_APP_FIRST_QUEST_BEGIN then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1197))
        local r8_1 = FindFormUI(frmQuestBegin, "questinfo")
        local r9_1 = FindFormUI(frmQuestBegin, "questaim")
        local r10_1 = FindFormUI(frmQuestBegin, "questhortation")
        SKY_Set(r8_1, PROP_UI_SHOW, VAR_TRUE)
        SKY_Set(r9_1, PROP_UI_SHOW, VAR_TRUE)
        SKY_Set(r10_1, PROP_UI_SHOW, VAR_TRUE)
        SKY_Set(FindFormUI(frmQuestBegin, "quesbutton_info"), PROP_UI_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_FIRST_DRAGON_ENERGY_EMPTY then
        prompt_close_proc()
        Newfirst_info(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1198))
      elseif r1_1 == MSG_APP_GET_GatherSkill_ID then
        return Get_AutoSkill(r2_1)
      elseif r1_1 == MSG_DEAD_DIALOG then
        local r8_1 = SKYParamParse(r2_1)
        acceptrelive_false()
        fullrelive_false()
        soonrelive_false()
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1199) .. r8_1)
        if r8_1 == 1 then
          fullrelive()
        elseif r8_1 == 2 then
          soonrelive()
        elseif r8_1 == 3 then
          soonrelive()
          fullrelive()
        elseif r8_1 == 0 then
          soonrelive_false()
          fullrelive_false()
          SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1200))
        end
      elseif r1_1 == MSG_OPEN_DEAD_DIALOG then
        SKY_Set(frmReactivating, PROP_UI_POS, 400, 150)
        SKY_Set(frmReactivating, PROP_UI_REFRESH)
        SKY_Set(frmReactivating, PROP_FORM_SHOW, VAR_TRUE)
      elseif r1_1 == MSG_APP_REVIAL then
        app_revive_time = SKYParamParse(r2_1)
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1201) .. app_revive_time)
        if app_revive_time ~= nil and app_revive_time <= 60 then
          acceptrelive()
          btnaccept_tag = 1
          SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1202) .. btnaccept_tag)
          SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1203))
          local r8_1 = FindFormUI(frmReactivating, "timecount")
          SKY_Set(r8_1, PROP_UI_TIME_INTERVAL, 1000)
          SKY_Set(r8_1, PROP_UI_TIME_START)
          local r10_1 = FindFormUI(frmReactivating, "timelabel")
          SKY_Set(r10_1, PROP_UI_TEXT, app_revive_time)
          SKY_Set(r10_1, PROP_UI_REFRESH)
          SKY_Set(frmReactivating, PROP_UI_REFRESH)
        end
      elseif r1_1 == MSG_APP_BEGWORDE_SAY then
        local r8_1 = SKYParamPop(r2_1)
        if r8_1 == 1 then
          SKY_Set(frmsay, PROP_FORM_SHOW, VAR_TRUE)
        elseif r8_1 == 2 then
          SKY_Set(frmNoirAnnounce, PROP_FORM_SHOW, VAR_TRUE)
        end
      elseif r1_1 == MSG_APP_VIEW_EQUIP then
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1204))
        SKY_Set(EquipView.form, PROP_FORM_SHOW, VAR_TRUE)
        EquipView_refresh(r2_1)
      elseif r1_1 == MSG_APP_EQUIP_REPAIR then
        local r8_1 = SKYParamParse(r2_1)
        local r9_1 = SKYGetBit(r8_1, 0)
        local r10_1 = SKYGetBit(r8_1, 1)
        if r9_1 == 0 then
          local r11_1 = FindFormUI(frmBuy, "btnrepair")
          SKY_Set(r11_1, PROP_UI_SHOW, VAR_FALSE)
          SKY_Set(r11_1, PROP_UI_REFRESH)
        else
          local r11_1 = FindFormUI(frmBuy, "btnrepair")
          SKY_Set(r11_1, PROP_UI_SHOW, VAR_TRUE)
          SKY_Set(r11_1, PROP_UI_REFRESH)
        end
        if r10_1 == 0 then
          local r11_1 = FindFormUI(frmBuy, "btnallrepair")
          SKY_Set(r11_1, PROP_UI_SHOW, VAR_FALSE)
          SKY_Set(r11_1, PROP_UI_REFRESH)
        else
          local r11_1 = FindFormUI(frmBuy, "btnallrepair")
          SKY_Set(r11_1, PROP_UI_SHOW, VAR_TRUE)
          SKY_Set(r11_1, PROP_UI_REFRESH)
        end
      elseif r1_1 == MSG_APP_DRAGON_ATTR then
        local r8_1 = SKY_Get(VAR_SCREEN, PROP_SCREEN_DESKTOP)
        local r9_1 = SKYParamPop(r2_1)
        dragon_habitus = SKYParamPop(r2_1)
        dragon_potential = SKYParamPop(r2_1)
        dragon_energy = SKYParamPop(r2_1)
        Show_ItemHint(r8_1, r9_1, 1)
        return VAR_TRUE
      elseif r1_1 == MSG_APP_NAMECHGE_RESULT then
        local r8_1 = SKYParamPop(r2_1)
        if r8_1 == 0 then
          local r9_1 = FindFormUI(frmfiydragon, "btnchangename")
          local r10_1 = FindFormUI(frmfiydragon, "flydragonmane")
          SKY_Set(r9_1, PROP_UI_SHOW, VAR_FALSE)
          SKY_Set(r10_1, PROP_UI_SHOW, VAR_TRUE)
          SKY_Set(frmfiydragon, PROP_UI_REFRESH)
        elseif r8_1 == 1 then
        end
      elseif r1_1 == MSG_APP_CHNG_DRG_NAME then
        local r8_1, r9_1, r10_1 = SKYParamParse(r2_1)
        local r11_1, r12_1 = SKY_Set(VAR_UI_DIALOG, PROP_UI_DIALOG_INPUTBOX, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1205))
        if r11_1 == VAR_TRUE and r12_1 ~= "" and r12_1 ~= nil then
          SKY_Set(VAR_APP, PROP_APP_CHNG_DRG_NAME, r8_1, r9_1, r10_1, r12_1)
        end
      elseif r1_1 == MSG_APP_CHANGE_NAME then
        dragon_name = 1
        local r8_1 = FindFormUI(frmfiydragon, "btnchangename")
        local r9_1 = FindFormUI(frmfiydragon, "flydragonmane")
        SKY_Set(r8_1, PROP_UI_SHOW, VAR_TRUE)
        SKY_Set(r9_1, PROP_UI_SHOW, VAR_FALSE)
        SKY_Set(frmfiydragon, PROP_UI_REFRESH)
      elseif r1_1 == MSG_APP_TARGET_PCHA then
        whether_dragon = SKYParamPop(r2_1)
      elseif r1_1 == MSG_APP_RIDE_DRAGON then
        dragon_pet = 1
        local r8_1 = 0
        r8_1 = SKYParamPop(r2_1)
        local r9_1 = SKYParamPop(r2_1)
        SKY_Set(frmPlaydragon, PROP_FORM_SHOW, VAR_TRUE)
        local r10_1 = FindFormUI(frmlongHotkey, "timerLongHotKeyShow")
        SKY_Set(r10_1, PROP_UI_TIME_INTERVAL, 1)
        SKY_Set(r10_1, PROP_UI_TIME_START)
        SKY_Set(FindFormUI(frmfiydragon, "flydragonmane"), PROP_UI_TEXT, r9_1)
        SKY_Set(frmfiydragon, PROP_UI_REFRESH)
        btnleft_tag = 1
        local r12_1 = FindFormUI(frmPlay, "hp_progress")
        local r13_1 = FindFormUI(frmPlay, "mp_progress")
        local r14_1 = tonumber(r8_1)
        SKYImageLoad(SKY_Get(FindFormUI(frmfiydragon, "dragonImage"), PROP_UI_IMAGE), "fdragon/fdragon1.dds", 190, 207, dragon_pic_dds[r14_1].x, dragon_pic_dds[r14_1].y)
        DragonFormInit(VAR_TRUE)
        local r16_1 = FindFormUI(frmDragonPetHotkey, "btnDragondown")
        SKYImageLoad(SKY_Get(r16_1, PROP_UI_IMAGE, 0), "main\\control.dds", 64, 64, dragon_pic_button_dds[r14_1].x, 464)
        SKYImageLoad(SKY_Get(r16_1, PROP_UI_IMAGE, 1), "main\\control.dds", 64, 64, dragon_pic_button_dds[r14_1].x, 540)
        SKYImageLoad(SKY_Get(r16_1, PROP_UI_IMAGE, 2), "main\\control.dds", 64, 64, dragon_pic_button_dds[r14_1].x, 540)
        SKYImageLoad(SKY_Get(r16_1, PROP_UI_IMAGE, 3), "main\\control.dds", 64, 64, dragon_pic_button_dds[r14_1].x, 540)
        for r21_1 = 0, 5, 1 do
          local r22_1 = FindFormUI(frmfiydragon, "imgSelect" .. r21_1)
          if r21_1 == 5 then
            SKY_Set(r22_1, PROP_UI_SHOW, VAR_TRUE)
          else
            SKY_Set(r22_1, PROP_UI_SHOW, VAR_FALSE)
          end
        end
        SKY_Set(FindFormUI(frmfiydragon, "btnCancelFeed"), PROP_UI_TAG, 5)
        SKY_Set(frmDragonPetHotkey, PROP_UI_REFRESH)
      elseif r1_1 == MSG_APP_GUILD_OCCUPATION then
        local r8_1 = SKYParamPop(r2_1)
        local r9_1 = SKYParamPop(r2_1)
        local r10_1 = SKYParamPop(r2_1)
        local r11_1 = SKYParamPop(r2_1)
        local r12_1 = nil
        local r13_1 = nil
        local r14_1 = nil
        local r15_1 = nil
        if r10_1 > 29 then
          r10_1 = 29
        end
        if r9_1 == 1 then
          r12_1 = "count2\\logo2.tga"
          r14_1 = SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1206)
          r13_1 = mapfileicon[math.floor(r10_1 / 9) + 1][math.mod(r10_1, 9) + 1]
          r15_1 = r11_1
        elseif r9_1 == 2 then
          r12_1 = "count2\\logo1.tga"
          r14_1 = SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1207)
          r13_1 = mapfileicon[math.floor(r10_1 / 9) + 1][math.mod(r10_1, 9) + 1]
          r15_1 = r11_1
        elseif r9_1 == 0 then
          r12_1 = ""
          r14_1 = SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1208)
          r15_1 = r11_1
          r13_1 = ""
        end
        SKY_Set(WorldMap.ui_map_south, PROP_UI_MAP_UPDATE_GUILD_CITY, r8_1, r12_1, r14_1, r13_1, r15_1)
        SKY_Set(WorldMap.ui_map_north, PROP_UI_MAP_UPDATE_GUILD_CITY, r8_1, r12_1, r14_1, r13_1, r15_1)
      elseif r1_1 == MSG_APP_DOWN_DRAGON then
        prompt_close_proc()
        dragon_pet = 0
        SKY_Set(frmPlaydragon, PROP_FORM_SHOW, VAR_FALSE)
        SKY_Set(frmdragonskillstart, PROP_FORM_SHOW, VAR_FALSE)
        SKY_Set(frmdragonSkillup, PROP_FORM_SHOW, VAR_FALSE)
        SKY_Set(FindFormUI(frmfiydragon, "property"), PROP_UI_SHOW, VAR_FALSE)
        SKY_Set(frmfiydragon, PROP_UI_REFRESH)
        local r9_1 = FindFormUI(frmPlay, "hp_progress")
        local r10_1 = FindFormUI(frmPlay, "mp_progress")
        DragonFormInit(VAR_FALSE)
        local r11_1 = FindFormUI(frmDragonPetHotkey, "btnDragondown")
        SKYImageLoad(SKY_Get(r11_1, PROP_UI_IMAGE, 0), "main\\control.dds", 64, 64, 777, 464)
        SKYImageLoad(SKY_Get(r11_1, PROP_UI_IMAGE, 1), "main\\control.dds", 64, 64, 777, 540)
        SKYImageLoad(SKY_Get(r11_1, PROP_UI_IMAGE, 2), "main\\control.dds", 64, 64, 777, 540)
        SKYImageLoad(SKY_Get(r11_1, PROP_UI_IMAGE, 3), "main\\control.dds", 64, 64, 777, 464)
        SKY_Set(frmDragonPetHotkey, PROP_UI_REFRESH)
      end
    end
  end
end
function player_zone_change(r0_2)
  -- line: [1261, 1275] id: 2
  if r0_2 ~= VAR_NULL then
    local r1_2 = SKY_Get(VAR_TABLE_AREA, PROP_TABLE_DATA, r0_2, "Description")
    local r2_2 = SKY_Get(VAR_TABLE_AREA, PROP_TABLE_DATA, r0_2, "Music")
    local r3_2 = SKY_Get(VAR_TABLE_AREA, PROP_TABLE_DATA, r0_2, "MusicPlayType")
    if r2_2 ~= nil then
      SKY_Set(VAR_SOUND, PROP_SOUND_MUSIC_STOP)
      SKY_Set(VAR_SOUND, PROP_SOUND_MUSIC, "music/mp3/" .. r2_2 .. ".mp3", r3_2)
    end
    if r1_2 ~= nil then
      maintext_show(r1_2)
    end
  end
end
function Get_AutoSkill(r0_3)
  -- line: [1277, 1324] id: 3
  local r1_3 = SKYParamParse(r0_3)
  local r2_3 = MainCha()
  local r3_3 = SKY_Get(r1_3, PROP_GAME_CHA_CtrlType)
  if r3_3 == 0 then
    return 1
  else
    local r4_3 = -1
    local r5_3 = SKY_Get(VAR_FORM_SKILL, PROP_SKILL_MAX)
    local r6_3 = table.getn(r5_3)
    local r7_3 = 0
    for r11_3 = 1, r6_3, 1 do
      local r12_3 = SKY_Get(r5_3[r11_3], PROP_ITEM_SKILL_ID)
      if tonumber(SKY_Get(VAR_TABLE_SKILL, PROP_TABLE_DATA, r12_3, "ExistSkill")) == r3_3 then
        SKY_Set(VAR_APP, PROP_APP_INFO, "skill_id: " .. r12_3)
        local r14_3 = tonumber(SKY_Get(VAR_TABLE_SKILL, PROP_TABLE_DATA, r12_3, "CurrentLevel"))
        local r15_3 = SKY_Get(r1_3, PROP_GAME_CHA_ATTR, VAR_ATTR_LEVEL)
        if r14_3 < r15_3 then
          maintext_show(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1209) .. r15_3 .. SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1210) .. SKY_Get(VAR_TABLE_SKILL, PROP_TABLE_DATA, r12_3, "SkillName") .. SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1211))
          return -1
        end
        local r16_3 = SKY_Get(r2_3, PROP_GAME_CHA_WeapHand, 1)
        if r16_3 == VAR_NULL then
          return r4_3
        else
          local r17_3 = SKY_Get(r16_3, PROP_WORLD_ITEM_ID)
          if r17_3 < 0 then
            return r4_3
          end
          if tonumber(SKY_Get(VAR_TABLE_SKILL, PROP_TABLE_DATA, r12_3, "MainWeapon")) == tonumber(SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, r17_3, "ItemType")) then
            r4_3 = r12_3
            return r4_3
          else
            return -1
          end
        end
      end
    end
    if r4_3 == -1 then
      maintext_show(SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1212))
    end
    return r4_3
  end
end
function allrepair_money(r0_4)
  -- line: [1325, 1355] id: 4
  allrepair_cost = 0
  for r5_4 = 1, 16, 2 do
    if a[r5_4] ~= 0 then
      if a[r5_4] > 0 then
        duration_max = SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, a[r5_4], "WearPointMax")
        repair_cost = SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, a[r5_4], "RepairPrice")
        repair_item = SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, a[r5_4], "ItemType")
        item_level = SKY_Get(VAR_TABLE_ITEM, PROP_TABLE_DATA, a[r5_4], "UseLevel")
      elseif a[r5_4] < 0 then
        duration_max = SKY_Get(VAR_TABLE_ITEM2, PROP_TABLE_DATA, math.abs(a[r5_4]), "WearPointMax")
        SKY_Set(VAR_APP, PROP_APP_INFO, SKY_Get(VAR_APP, PROP_APP_SETGET_STRMAG, 1213) .. duration_max)
        repair_cost = SKY_Get(VAR_TABLE_ITEM2, PROP_TABLE_DATA, math.abs(a[r5_4]), "RepairPrice")
        repair_item = SKY_Get(VAR_TABLE_ITEM2, PROP_TABLE_DATA, math.abs(a[r5_4]), "ItemType")
        item_level = SKY_Get(VAR_TABLE_ITEM2, PROP_TABLE_DATA, math.abs(a[r5_4]), "UseLevel")
      end
      a[r5_4 + 1] = math.ceil(a[(r5_4 + 1)] / 100) * 100
      repair_cost = (duration_max - a[r5_4 + 1]) * repair_cost / 10000
      repair_cost = math.ceil((0.2 + item_level / 100) * repair_cost)
      allrepair_cost = repair_cost + allrepair_cost
    end
  end
  return allrepair_cost
end
function showfirstmsg(r0_5)
  -- line: [1357, 1369] id: 5
  local r1_5 = FindFormUI(frmNPC_pageboy, "test_memo")
  local r2_5 = FindFormUI(frmNPC_pageboy, "pageup")
  local r3_5 = FindFormUI(frmNPC_pageboy, "pagedown")
  SKY_Set(r1_5, PROP_UI_MEMO_CLEAR)
  showOff()
  changememo(false)
  SKY_Set(VAR_HELP_FORM, PROP_HELP_CONTENT_INDEX, r0_5)
  SKY_Set(frmNPC_pageboy, PROP_UI_REFRESH)
end
function Newfirst_info(r0_6, r1_6, r2_6, r3_6, r4_6)
  -- line: [1372, 1402] id: 6
  local r5_6 = frmNewHelp
  local r6_6 = SKY_Get(r5_6, PROP_FORM_FIND, "lblMPrompt")
  SKY_Set(r6_6, PROP_UI_MEMO_CLEAR)
  SKY_Set(r6_6, PROP_UI_MEMO_NEW_TEXT, r0_6, DEFALUT_FONT, SKYArgbToColor(255, 0, 0, 0))
  if r1_6 ~= nil then
    SKY_Set(r6_6, PROP_UI_MEMO_APPEND_TEXT, r1_6, DEFALUT_FONT, COLOR_RED)
  end
  if r2_6 ~= nil then
    SKY_Set(r6_6, PROP_UI_MEMO_APPEND_TEXT, r2_6, DEFALUT_FONT, SKYArgbToColor(255, 0, 0, 0))
  end
  SKY_Set(r6_6, PROP_UI_MEMO_PARSE)
  local r7_6 = SKY_Get(r5_6, PROP_FORM_FIND, "timerPromptShow")
  SKY_Set(r7_6, PROP_UI_TIME_INTERVAL, 1000)
  SKY_Set(r7_6, PROP_UI_TIME_START)
  SKY_Set(r5_6, PROP_UI_REFRESH)
  SKY_Set(r5_6, PROP_FORM_SHOW, VAR_TRUE)
  local r8_6 = FindFormUI(frmNewHelp, "cartoonhelp")
  if r3_6 ~= nil and r3_6 == "show" then
    SKY_Set(r8_6, PROP_UI_SHOW, VAR_TRUE)
    Help_cartoonform_tempid = 1
    Help_cartoonform_tempname = r4_6
    Help_cartoon_show(Help_cartoon_table, r4_6)
    SKY_Set(frmNewHelp, PROP_UI_REFRESH)
    return 
  end
  SKY_Set(r8_6, PROP_UI_SHOW, VAR_FALSE)
end